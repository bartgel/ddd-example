import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as o}from"./index.66AI1_x2.js";import{a as j,b as F}from"./url-builder.Ci7yX7Vs.js";import{g as L,S as k,T as A,P as C}from"./components.ChMrURz-.js";import{a as w,F as M}from"./ServerIcon.DkuCCljB.js";import{B}from"./box.Dpj119uS.js";import{a as $}from"./EnvelopeIcon.D1la4CBn.js";import{F as D}from"./QueueListIcon.CFcY8mzd.js";import{F as U}from"./Squares2X2Icon.BUnB1vlz.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./createLucideIcon.BukmfUhN.js";const _=o.memo(({message:s,collection:m})=>{const{Icon:l,color:x}=L(s.collection);return e.jsxs("a",{href:j(`/docs/${s.collection}/${s.data.id}/${s.data.version}`),className:"group flex border border-gray-200 items-center gap-1 rounded-md text-[11px] font-medium hover:bg-gray-50 transition-colors duration-200 bg-white",children:[e.jsx("div",{className:"bg-white border-r border-gray-200 px-2 py-1.5 rounded-l-md",children:e.jsx(l,{className:`h-3 w-3 text-${x}-500`})}),e.jsx("span",{className:"px-1 py-1 truncate max-w-[140px]",children:s.data.name})]})}),P=o.memo(({messages:s,type:m,selectedTypes:l})=>{const x=m==="receives"?"blue":"green",f=4,g=s?.filter(i=>l.length===0||l.includes(i.collection)),p=g?.slice(0,f),n=g?g.length-f:0;return e.jsx("div",{className:`flex-1 h-full flex flex-col bg-${x}-100 border border-${x}-300 rounded-lg p-4`,children:e.jsxs("div",{className:"space-y-2 flex-1",children:[p?.map(i=>e.jsx(_,{message:i,collection:i.collection},i.data.name)),n>0&&e.jsx("div",{className:"text-center py-1",children:e.jsxs("p",{className:"text-gray-500 text-[10px]",children:["+ ",n," more"]})}),(!s?.length||l.length>0&&!s?.some(i=>l.includes(i.collection)))&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-[10px]",children:l.length>0?`Service does not ${m} ${l.join(" or ")}`:`Service does not ${m} any messages`})})]})})}),y=o.memo(({service:s,urlParams:m,selectedTypes:l})=>e.jsx("a",{href:F("/architecture/messages",{serviceName:s.data.name,serviceId:s.data.id,domainId:m?.domainId,domainName:m?.domainName}),className:"group hover:bg-pink-50 bg-white border-2 border-dashed border-pink-400 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden ",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(w,{className:"h-5 w-5 text-pink-500"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate group-hover:underline transition-colors duration-200 w-full max-w-[90%]",children:[s.data.name||s.data.id," (v",s.data.version,")"]})]})}),s.data.summary&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 min-h-[2.5rem]",children:s.data.summary}),!m?.serviceName&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(P,{messages:s.data.receives,type:"receives",selectedTypes:l}),e.jsxs("div",{className:"flex items-center gap-2 max-w-[200px]",children:[e.jsx("div",{className:"w-4 h-[2px] bg-blue-200"}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(w,{className:"h-8 w-8 text-pink-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.data.name||s.data.id}),e.jsxs("p",{className:"text-xs text-gray-500",children:["v",s.data.version]})]})]})}),e.jsx("div",{className:"w-4 h-[2px] bg-emerald-200"})]}),e.jsx(P,{messages:s.data.sends,type:"sends",selectedTypes:l})]})]})})),G=o.memo(({domain:s,services:m,urlParams:l,selectedTypes:x,isMultiColumn:f})=>{const g=s.data.domains||[],p=g.map(i=>i.data.services||[]).flat(),n=m.filter(i=>!p.some(r=>r.id===i.data.id));return e.jsxs("div",{className:"space-y-6",children:[n.length>0&&e.jsx("div",{className:`grid gap-6 ${f?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:n.map(i=>e.jsx(y,{service:i,urlParams:l,selectedTypes:x},i.data.id))}),g.map(i=>{const r=s.data.domains?.find(d=>d.data.id===i.data.id);if(!r)return null;const v=m.filter(d=>r.data.services?.some(a=>a.id===d.data.id));return v.length===0?null:e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-orange-500"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[r.data.name," (Subdomain)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:j(`/visualiser/domains/${r.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:j(`/docs/domains/${r.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white rounded-md transition-colors duration-200",children:"Read documentation"})]})]}),r.data.entities&&r.data.entities.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 xl:grid-cols-4 gap-6",children:r.data.entities.map(d=>e.jsx("a",{href:j(`/docs/entities/${d.id}`),className:"bg-white border-2 border-dashed border-purple-400 rounded-lg p-4 space-y-4 hover:bg-purple-50 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-purple-500"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[d.id," (Entity)"]})]})},d.id))}),e.jsx("div",{className:`grid gap-6 ${f?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:v.map(d=>e.jsx(y,{service:d,urlParams:{...l,domainId:r.data.id,domainName:`${r.data.name} (Subdomain)`},selectedTypes:x},d.data.id))})]},r.data.id)})]})});function T({services:s,domains:m,embeded:l}){const[x,f]=o.useState(""),[g,p]=o.useState(1),[n,i]=o.useState([]),[r,v]=o.useState(!1),d=16,[a,E]=o.useState(null);o.useEffect(()=>{const t=new URLSearchParams(window.location.search);E({serviceIds:t.get("serviceIds")?.split(",").filter(Boolean),domainId:t.get("domainId")||void 0,domainName:t.get("domainName")||void 0,serviceName:t.get("serviceName")||void 0})},[]),o.useEffect(()=>{if(typeof window<"u"){const t=localStorage.getItem("EventCatalog:ServiceColumnLayout");t!==null&&v(t==="multi")}},[]);const R=()=>{const t=!r;v(t),typeof window<"u"&&localStorage.setItem("EventCatalog:ServiceColumnLayout",t?"multi":"single")},c=o.useMemo(()=>{if(a===null)return[];let t=[...s];if(a.serviceIds?.length&&(t=t.filter(h=>a.serviceIds?.includes(h.data.id)&&!h.data.id.includes("/versioned/"))),x){const h=x.toLowerCase();t=t.filter(u=>u.data.name?.toLowerCase().includes(h)||u.data.summary?.toLowerCase().includes(h)||u.data.sends?.some(N=>N.data.name.toLowerCase().includes(h))||u.data.receives?.some(N=>N.data.name.toLowerCase().includes(h)))}return n.length>0&&(t=t.filter(h=>{const u=h.data.sends?.some(b=>n.includes(b.collection)),N=h.data.receives?.some(b=>n.includes(b.collection));return u||N})),t.sort((h,u)=>(h.data.name||h.data.id).localeCompare(u.data.name||u.data.id)),t},[s,x,a,n]),S=o.useMemo(()=>{if(a?.domainId||a?.serviceIds?.length)return c;const t=(g-1)*d;return c.slice(t,t+d)},[c,g,a]),I=o.useMemo(()=>a?.domainId||a?.serviceIds?.length?1:Math.ceil(c.length/d),[c.length,a]);return o.useEffect(()=>{p(1)},[x,n]),e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:j("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"Domains"]}),e.jsx($,{className:"h-4 w-4"}),e.jsxs("a",{href:j("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Services"]}),a?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:a.domainId})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:a?.domainId?`${a.domainName} Architecture`:"All Services"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:a?.domainId?`Browse services and messages in the ${a.domainId} domain`:"Browse and discover services in your event-driven architecture"})]}),e.jsxs("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0 flex items-center gap-3",children:[e.jsx(k,{searchQuery:x,onSearchChange:f,placeholder:"Search services by name, summary, or messages...",totalResults:c.length,totalItems:s.length}),e.jsx("button",{onClick:R,className:"flex items-center justify-center p-2 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors duration-200",title:r?"Switch to single column":"Switch to multi column",children:r?e.jsx(D,{className:"h-5 w-5 text-gray-600"}):e.jsx(U,{className:"h-5 w-5 text-gray-600"})})]})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(A,{selectedTypes:n,onTypeChange:i,filteredCount:c.length,totalCount:s.length}),e.jsx("div",{className:"text-sm text-gray-500",children:a?.domainId||a?.serviceIds?.length?e.jsxs("span",{children:["Showing ",c.length," services in the ",a.domainId," domain"]}):e.jsxs("span",{children:["Showing ",(g-1)*d+1," to"," ",Math.min(g*d,c.length)," of ",c.length," ","services"]})}),!(a?.domainId||a?.serviceIds?.length)&&e.jsx(C,{currentPage:g,totalPages:I,totalItems:c.length,itemsPerPage:d,onPageChange:p})]})}),c.length>0&&e.jsx("div",{className:`rounded-xl overflow-hidden ${a?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-400":""}`,children:a?.domainName?m.filter(t=>t.data.id===a.domainId).map(t=>e.jsx(G,{domain:t,services:S,urlParams:a,selectedTypes:n,isMultiColumn:r},t.data.id)):e.jsx("div",{className:`grid gap-6 ${r?"grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2":"grid-cols-1"}`,children:S.map(t=>e.jsx(y,{service:t,urlParams:a,selectedTypes:n},t.data.id))})}),c.length===0&&e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-lg",children:n.length>0?`No services found that ${n.length>1?"handle":"handles"} ${n.join(" or ")} messages`:"No services found matching your criteria"})}),!(a?.domainId||a?.serviceIds?.length)&&e.jsx("div",{className:"mt-8 border-t border-gray-200",children:e.jsx(C,{currentPage:g,totalPages:I,totalItems:c.length,itemsPerPage:d,onPageChange:p})})]})}export{T as default};
