import{d as _,F as A,J as D,c as k,R as $,K as j,b as f,o,k as w,x as E,f as i,e as C,N as z,L as I,M as P,q as c,O as R,z as q,u as t,P as B,t as L,w as v,$ as U,D as g,Q as M,S as O,T}from"./_OpenAPI.CuaEDb0H.js";import{w as V}from"./DeleteSidebarListElement.vue.zwe9Rtgr.js";import{q as F}from"./Form.vue.BDeVtZ6y.js";import"./jsx-runtime.DCqPeNwG.js";import"./index.66AI1_x2.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./preload-helper.D_1diwkG.js";import"./index.jDpCNB1z.js";import"./floating-ui.dom.CMverA8Q.js";import"./ViewLayoutSection.vue.Cb_ixnp3.js";const W={class:"bg-b-1 divide-0.5 flex w-full flex-col divide-y text-sm"},G=_({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(e){const l=e,{activeWorkspaceCollections:s}=A(),{servers:t,serverMutators:a}=D(),r=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],n=k((()=>{const e=s.value.find((e=>e.uid===l.collectionId));return t[e&&"string"==typeof l.serverUid&&"default"===l.serverUid?e.servers[0]??"":e?.servers.find((e=>e===l.serverUid))??""]})),u=k((()=>{var e,l;return null!=(e=n.value)&&e.url?(null==(l=n.value.url.match($.PATH))?void 0:l.map((e=>e.slice(1,-1))))??[]:[]}));j(u,(e=>{if(!n.value)return;const l=n.value.variables?{...n.value.variables}:{};Object.keys(l).forEach((s=>{e.includes(s)||delete l[s]})),e.forEach((e=>{l[e]||(l[e]={default:""})})),a.edit(n.value.uid,"variables",l)}),{immediate:!0});const d=(e,l)=>{!s.value||!n.value||a.edit(n.value.uid,e,l)},v=(e,l)=>{if(!n.value)return;const s=n.value.variables||{};s[e]={...s[e],default:l},a.edit(n.value.uid,"variables",s)};return(e,l)=>(o(),f("div",W,[n.value?(o(),f(E,{key:0},[i(F,{data:n.value,onUpdate:d,options:r},null,8,["data"]),n.value.variables?(o(),C(z,{key:0,variables:n.value.variables,"onUpdate:variable":v},null,8,["variables"])):w("",!0)],64)):w("",!0)]))}}),H={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},Y={class:"flex flex-col gap-4"},J={class:"bg-b-2 overflow-hidden rounded-lg border"},K={class:"flex items-center justify-between py-1 pl-3 pr-1 text-sm"},Q={key:1},X={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},ce=_({__name:"CollectionServers",setup(e){const{activeCollection:l}=A(),{servers:s,events:a,serverMutators:r}=D(),n=I(),u=P(null),d=k((()=>{var e;return s&&null!=(e=l.value)&&e.servers?Object.values(s).filter((e=>{var s;return null==(s=l.value)?void 0:s.servers.includes(e.uid)})):[]})),p=()=>a.commandPalette.emit({commandName:"Add Server"}),m=()=>{var e;null==(e=l.value)||!e.uid||!u.value||(r.delete(u.value,l.value.uid),n.hide())};return(e,a)=>{var r;return o(),f("div",H,[c("div",Y,[a[3]||(a[3]=R('<div class="flex items-start justify-between gap-2"><div class="flex flex-col"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(o(!0),f(E,null,q(d.value,((e,s)=>(o(),f("div",{key:e.uid},[c("div",J,[c("div",K,[e.description?(o(),C(t(B),{key:0,value:e.description},null,8,["value"])):(o(),f("span",Q,"Server "+L(s+1),1)),i(t(O),{placement:"bottom-end"},{items:v((()=>[i(t(M),{class:"flex gap-2 font-normal",onClick:l=>(e=>{u.value=e,n.show()})(e.uid)},{default:v((()=>[i(t(g),{class:"inline-flex",icon:"Delete",size:"sm",thickness:"1.5"}),a[1]||(a[1]=c("span",null,"Delete",-1))])),_:2},1032,["onClick"])])),default:v((()=>[i(t(U),{class:"hover:bg-b-3 h-full max-h-8 gap-1 p-1 text-xs",variant:"ghost"},{default:v((()=>[i(t(g),{class:"text-c-3",icon:"Ellipses",size:"md"})])),_:1})])),_:2},1024)]),t(l)?(o(),C(G,{key:0,collectionId:t(l).uid,serverUid:e.uid},null,8,["collectionId","serverUid"])):w("",!0)])])))),128)),c("div",X,[i(t(U),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:p},{default:v((()=>[i(t(g),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),a[2]||(a[2]=c("span",null,"Add Server",-1))])),_:1})])]),i(t(T),{size:"xxs",state:t(n),title:`Delete ${u.value?null==(r=t(s)[u.value])?void 0:r.url:"Server"}`},{default:v((()=>[i(V,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:a[0]||(a[0]=e=>t(n).hide()),onDelete:m})])),_:1},8,["state","title"])])}}});export{ce as default};