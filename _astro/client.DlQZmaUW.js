async function R(a,e,o){const{callbackUrl:n=window.location.href,redirect:r=!0}={},{prefix:c="/api/auth",...t}={},i="credentials"===a,l=i||"email"===a,s=`${c}/${i?"callback":"signin"}/${a}?${new URLSearchParams(o)}`,w=await fetch(`${c}/csrf`),{csrfToken:d}=await w.json(),f=await fetch(s,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...t,csrfToken:d,callbackUrl:n})}),h=await f.clone().json(),u=new URL(h.url).searchParams.get("error");return!r&&l&&u?f:(window.location.href=h.url??n,void(h.url.includes("#")&&window.location.reload()))}async function g(a){const{callbackUrl:e=window.location.href,prefix:o="/api/auth"}={},n=await fetch(`${o}/csrf`),{csrfToken:r}=await n.json(),c=(await(await fetch(`${o}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:r,callbackUrl:e})})).json()).url??e;window.location.href=c,c.includes("#")&&window.location.reload()}export{g as a,R as s};