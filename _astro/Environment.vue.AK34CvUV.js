import{d as T,M as E,c as le,K as L,b as D,o as d,k as j,x as R,H as O,B as w,e as _,u as s,D as B,q as C,z as P,X as oe,aF as Ce,f,av as ke,w as h,T as q,J as te,E as G,aE as ye,$ as J,t as H,aG as ae,ax as ge,aH as Ee,F as we,U as _e,L as K,ay as g,a2 as $e,aI as Ie,Z as ze,Y as Se,p as Ve,aw as je}from"./_OpenAPI.CuaEDb0H.js";import{d as De}from"./LibraryIcon.vue.BL8fHMTk.js";import{C as Me}from"./EditSidebarListElement.vue.BN-zxo-E.js";import{m as Ne,g as Be}from"./SidebarButton.vue.eGuSLwBu.js";import{h as We,b as Ue,_ as Fe,a as ee}from"./CommandActionInput.vue.8QCIjryT.js";import{u as Oe}from"./ViewLayout.vue.BfL5eU10.js";import{x as Re}from"./ViewLayoutContent.vue.DAf3wOHK.js";import{_ as Te}from"./ViewLayoutSection.vue.Cb_ixnp3.js";import{a as Ae}from"./DeleteSidebarListElement.vue.zwe9Rtgr.js";import"./jsx-runtime.DCqPeNwG.js";import"./index.66AI1_x2.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./preload-helper.D_1diwkG.js";import"./index.jDpCNB1z.js";import"./floating-ui.dom.CMverA8Q.js";import"./ScalarHotkey.vue.iDwJ3vmx.js";const Ke=["onClick"],Pe=["placeholder"],ne=T({__name:"EnvironmentColors",props:{activeColor:{},selector:{type:Boolean,default:!1}},emits:["select"],setup(e,{emit:l}){const o=e,a=l,n=E(""),t=E(null),r=E(!1),i=E(!1),c=[{color:"#8E8E8E"},{color:"#EF0006"},{color:"#EDBE20"},{color:"#069061"},{color:"#FB892C"},{color:"#0082D0"},{color:"#5203D1"},{color:"#FFC0CB"}],u=le((()=>o.activeColor&&!c.some((e=>e.color===o.activeColor))||n.value?`background-color: ${o.activeColor||n.value};`:"background: linear-gradient(to right, rgb(235, 87, 87), rgb(242, 201, 76), rgb(76, 183, 130), rgb(78, 167, 252), rgb(250, 96, 122));")),v=()=>{r.value=!r.value,o.selector&&(i.value=!1),ke((()=>{t.value&&t.value.focus()}))};L(n,(e=>{e&&!e.startsWith("#")&&(n.value=`#${e}`),r.value=!0}));const m=()=>{o.selector&&(i.value=!i.value)},p=e=>{a("select",e),o.selector&&(i.value=!1)};return(e,l)=>(d(),D("div",null,[r.value?j("",!0):(d(),D(R,{key:0},[o.selector&&!i.value?(d(),D("div",{key:0,class:w(["flex cursor-pointer items-center justify-center rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:e.activeColor}),onClick:m},[e.activeColor?(d(),_(s(B),{key:0,class:w(["text-c-btn",o.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):j("",!0)],6)):j("",!0),i.value||!o.selector?(d(),D("div",{key:1,class:w(["color-selector flex flex-row items-center justify-between gap-1.5 space-x-1",o.selector?"h-4":"min-h-10 min-w-[296px]"])},[(d(),D(R,null,P(c,(l=>C("div",{key:l.color,class:w(["flex cursor-pointer items-center justify-center rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:l.color}),onClick:e=>p(l.color)},[e.activeColor!==l.color||n.value?j("",!0):(d(),_(s(B),{key:0,class:w(["text-c-btn",o.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"]))],14,Ke))),64)),l[2]||(l[2]=C("hr",{class:"border-ghost h-5 w-0.5 border-l"},null,-1)),C("label",{class:w(["z-10 flex cursor-pointer flex-row items-center justify-center gap-2 rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O(u.value),onClick:v},[r.value||e.activeColor!==n.value&&(!e.activeColor||c.some((l=>l.color===e.activeColor)))?j("",!0):(d(),_(s(B),{key:0,class:"text-c-btn",icon:"Checkmark",size:"xs"}))],6)],2)):j("",!0)],64)),r.value?(d(),D("div",{key:1,class:w(["color-selector flex flex-1 items-center gap-2 rounded",o.selector?"h-4":"min-h-10"])},[C("span",{class:w(["absolute rounded-full border border-dashed",o.selector?"h-4 w-4":"h-5 w-5"])},null,2),C("span",{class:w(["z-[1] rounded-full",o.selector?"h-4 w-4":"h-5 w-5"]),style:O(u.value)},null,6),oe(C("input",{ref_key:"customColorInputRef",ref:t,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),class:"w-full flex-1 border-transparent text-sm outline-none",placeholder:e.activeColor||"#000000",type:"text",onInput:l[1]||(l[1]=e=>p(n.value))},null,40,Pe),[[Ce,n.value]]),C("button",{class:"text-c-3 hover:bg-b-2 rounded-lg p-1.5",type:"button",onClick:v},[f(s(B),{icon:"Checkmark",size:"xs"})])],2)):j("",!0)]))}}),Ge={class:"flex flex-col gap-4"},Je=T({__name:"EnvironmentColorModal",props:{state:{},selectedColor:{}},emits:["cancel","submit"],setup(e,{emit:l}){const o=e,a=l,n=E(""),t=e=>{n.value=e},r=()=>{a("submit",n.value),n.value=""};return(e,l)=>(d(),_(s(q),{size:"xxs",state:e.state,title:"Edit Environment Color"},{default:h((()=>[C("div",Ge,[f(ne,{activeColor:n.value||o.selectedColor,class:"w-full p-1",onSelect:t},null,8,["activeColor"]),f(Ae,{onCancel:l[0]||(l[0]=e=>a("cancel")),onSubmit:r})])])),_:1},8,["state"]))}}),He={class:"flex items-start gap-2"},Le=T({__name:"EnvironmentModal",props:{state:{},activeWorkspaceCollections:{},collectionId:{}},emits:["cancel","submit"],setup(e,{emit:l}){const o=e,a=l,{events:n}=te(),t=E(""),r=E("#8E8E8E"),i=le((()=>[...o.activeWorkspaceCollections.filter((e=>{var l;return"Drafts"!==(null==(l=e.info)?void 0:l.title)})).map((e=>{var l;return{id:e.uid,label:(null==(l=e.info)?void 0:l.title)??"Untitled Collection"}}))])),c=E(i.value.find((e=>e.id===o.collectionId))),{toast:u}=ae(),v=e=>{r.value=e};L((()=>o.state.open),(e=>{e&&(t.value="",r.value="#8E8E8E",o.collectionId?c.value=i.value.find((e=>e.id===o.collectionId)):c.value=void 0)}));const m=()=>{var e,l,o,n;null!=(e=c.value)&&e.id?a("submit",{name:t.value,color:r.value,type:"global"===(null==(l=c.value)?void 0:l.id)?"global":"collection",collectionId:"global"!==(null==(o=c.value)?void 0:o.id)?null==(n=c.value)?void 0:n.id:void 0}):u("Please select a collection before adding an environment.","error")},p=()=>{o.state.hide(),n.commandPalette.emit({commandName:"Create Collection"})};return(e,l)=>(d(),_(s(q),{bodyClass:"border-t-0 rounded-t-lg",size:"xs",state:e.state},{default:h((()=>[f(We,{disabled:!c.value,onCancel:l[2]||(l[2]=e=>a("cancel")),onSubmit:m},{options:h((()=>[f(s(ye),{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e),options:i.value,placeholder:"Select Type"},{default:h((()=>[i.value.length>0?(d(),_(s(J),{key:0,class:"hover:bg-b-2 max-h-8 w-fit justify-between gap-1 p-2 text-xs",variant:"outlined"},{default:h((()=>[C("span",{class:w(c.value?"text-c-1":"text-c-3")},H(c.value?c.value.label:"Select Collection"),3),f(s(B),{class:"text-c-3",icon:"ChevronDown",size:"xs"})])),_:1})):(d(),_(s(J),{key:1,class:"hover:bg-b-2 max-h-8 justify-between gap-1 p-2 text-xs",variant:"outlined",onClick:p},{default:h((()=>l[3]||(l[3]=[C("span",{class:"text-c-1"},"Create Collection",-1)]))),_:1}))])),_:1},8,["modelValue","options"])])),submit:h((()=>l[4]||(l[4]=[G(" Add Environment ")]))),default:h((()=>[C("div",He,[f(ne,{activeColor:r.value,class:"peer",selector:"",onSelect:v},null,8,["activeColor"]),f(Ue,{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),class:"-mt-[.5px] !p-0 peer-has-[.color-selector]:hidden",placeholder:"Environment name"},null,8,["modelValue"])])])),_:1},8,["disabled"])])),_:1},8,["state"]))}}),qe={class:"flex-1"},Xe=["onClick"],Ye={class:"flex h-5 max-w-[14px] items-center justify-center"},pl=T({__name:"Environment",setup(e){const l=ge(),o=Ee(),{activeWorkspace:a,activeEnvironment:n,activeWorkspaceCollections:t,activeEnvVariables:r}=we(),{events:i,workspaceMutators:c,collectionMutators:u}=te(),{collapsedSidebarFolders:v,toggleSidebarFolder:m}=_e(),p=K(),b=K(),x=K(),k=E(null),y=E("default"),I=E(""),S=E(void 0),z=E(void 0),O=E(void 0),{toast:V}=ae();function M(e,l,o){var a;e&&(l.uid===o?V(`Environment name already used in ${null==(a=l.info)?void 0:a.title}`,"error"):V("Environment name already used in another collection","error"))}function A(e){t.value.some((l=>{const o=Object.keys(l["x-scalar-environments"]||{}).includes(e.name);return M(o,l,e.collectionId),o}))||(e.collectionId&&(u.addEnvironment(e.name,{variables:{},color:e.color},e.collectionId),v[e.collectionId]||m(e.collectionId),l.push({name:"environment.collection",params:{[g.Collection]:e.collectionId,[g.Environment]:e.name}})),b.hide())}function N(e){var l,o;if(n){const n=(e=>JSON.parse(e))(e);if("default"===y.value)c.edit(null==(l=a.value)?void 0:l.uid,"environments",n);else{const e=t.value.find((e=>{var l;return null==(l=e["x-scalar-environments"])?void 0:l[y.value??""]}));if(null!=(o=e?.["x-scalar-environments"])&&o[y.value??""]){const l=e["x-scalar-environments"][y.value??""];l&&(l.variables=n,u.edit(e.uid,"x-scalar-environments",e["x-scalar-environments"]))}}}}const T=e=>{S.value=e,b.show()},W=e=>{const l=k.value;"string"==typeof l&&(t.value.some((e=>{var o;return null==(o=e["x-scalar-environments"])?void 0:o[l]}))&&t.value.forEach((o=>{var a;null!=(a=o["x-scalar-environments"])&&a[l]&&(o["x-scalar-environments"][l].color=e,u.edit(o.uid,"x-scalar-environments",o["x-scalar-environments"]))})),p.hide())};const F=()=>{var e,l,o,n;return"default"===y.value?JSON.stringify(null==(e=a.value)?void 0:e.environments,null,2):JSON.stringify(null==(n=null==(o=null==(l=t.value.find((e=>{var l;return null==(l=e["x-scalar-environments"])?void 0:l[y.value??""]})))?void 0:l["x-scalar-environments"])?void 0:o[y.value??""])?void 0:n.variables,null,2)},U=e=>v[e],$=e=>{null!=e&&e.createNew&&"environment"===o.name&&T()};L((()=>[o.params[g.Collection],o.params[g.Environment]]),(([e,l])=>{y.value=e?l:"default"})),$e((()=>{y.value=o.params[g.Environment]||"default",i.hotKeys.on($);const e=o.params[g.Collection];e&&!v[e]&&m(e)})),Ie((()=>i.hotKeys.off($)));function Y(){z.value=void 0,S.value=void 0,O.value=void 0,x.hide()}function X(e){t.value.some((l=>{const o=Object.keys(l["x-scalar-environments"]||{}).includes(e);return M(o,l,S.value),o}))||(e&&"default"!==z.value&&t.value.forEach((l=>{var o;if(null!=(o=l["x-scalar-environments"])&&o[z.value??""]){const o=l["x-scalar-environments"][z.value??""];o&&(delete l["x-scalar-environments"][z.value??""],l["x-scalar-environments"][e]=o,u.edit(l.uid,"x-scalar-environments",l["x-scalar-environments"]))}})),e&&y.value===z.value&&(y.value=e),z.value=void 0,S.value=void 0,O.value=void 0,x.hide())}return(e,o)=>(d(),_(Oe,null,{default:h((()=>[f(Ne,{title:"Collections"},{content:h((()=>[C("div",qe,[f(Fe,null,{default:h((()=>[(d(),_(ee,{key:"default",class:"text-xs",isCopyable:!1,to:{name:"environment.default",params:{[s(g).Environment]:"default"}},type:"environment",variable:{name:"Global Environment",uid:"default",icon:"Globe",isDefault:!0}},null,8,["to"])),(d(!0),D(R,null,P(s(t),(e=>{var n;return d(),D("li",{key:e.uid,class:"gap-1/2 flex flex-col"},[C("button",{class:"hover:bg-b-2 group flex w-full items-center gap-1.5 break-words rounded p-1.5 text-left text-sm font-medium",type:"button",onClick:l=>s(m)(e.uid)},[C("span",Ye,[f(s(De),{class:"text-sidebar-c-2 size-3.5 min-w-3.5 stroke-2 group-hover:hidden",src:e["x-scalar-icon"]||"interface-content-folder"},null,8,["src"]),C("div",{class:w({"rotate-90":s(v)[e.uid]})},[f(s(B),{class:"text-c-3 hover:text-c-1 hidden text-sm group-hover:block",icon:"ChevronRight",size:"md"})],2)]),G(" "+H((null==(n=e.info)?void 0:n.title)??""),1)],8,Xe),oe(C("div",{class:w({"before:bg-border before:z-1 relative mb-[.5px] before:pointer-events-none before:absolute before:left-3 before:top-0 before:h-[calc(100%_+_.5px)] before:w-[.5px] last:mb-0 last:before:h-full":Object.keys(e["x-scalar-environments"]||{}).length>0})},[(d(!0),D(R,null,P(e["x-scalar-environments"],((o,n)=>(d(),_(ee,{key:n,class:"text-xs [&>a]:pl-5",collectionId:e.uid,isCopyable:!1,isDeletable:!0,isRenameable:!0,to:{name:"collection.environment",params:{[s(g).Collection]:e.uid,[s(g).Environment]:n}},type:"environment",variable:{name:n,uid:n,color:o.color??"#8E8E8E",isDefault:!1},warningMessage:"Are you sure you want to delete this environment?",onClick:ze((o=>((e,o,n)=>{var t,s;const r=n?{name:"environment.collection",params:{[g.Workspace]:null==(t=a.value)?void 0:t.uid,[g.Collection]:n,[g.Environment]:o}}:{name:"environment.default",params:{[g.Workspace]:null==(s=a.value)?void 0:s.uid,[g.Environment]:o}};e.metaKey?window.open(l.resolve(r).href,"_blank"):l.push(r)})(o,n,e.uid)),["prevent"]),onColorModal:e=>(e=>{var l,o,a;k.value=e,I.value=(null==(a=null==(o=null==(l=t.value.find((l=>{var o;return null==(o=l["x-scalar-environments"])?void 0:o[e]})))?void 0:l["x-scalar-environments"])?void 0:o[e])?void 0:a.color)??"",p.show()})(n),onDelete:e=>function(e){t.value.forEach((l=>{u.removeEnvironment(e,l.uid)}));const o=t.value.flatMap((e=>Object.keys(e["x-scalar-environments"]||{})));if(o.length>0){const e=o[o.length-1];if(!e)return;const a=t.value.find((l=>Object.keys(l["x-scalar-environments"]||{}).includes(e)));y.value=e,l.push({name:"environment.collection",params:{collectionId:a?.uid,environmentId:e}}),a&&!v[a.uid]&&m(a.uid)}else y.value="default",l.push({name:"environment",params:{environment:"default"}})}(n),onRename:l=>((e,l)=>{z.value=e,S.value=l,O.value=e,x.show()})(n,e.uid)},null,8,["collectionId","to","variable","onClick","onColorModal","onDelete","onRename"])))),128)),0===Object.keys(e["x-scalar-environments"]||{}).length?(d(),_(s(J),{key:0,class:"text-c-1 hover:bg-b-2 flex h-8 w-full justify-start gap-1.5 py-0 pl-6 text-xs",variant:"ghost",onClick:l=>T(e.uid)},{default:h((()=>[f(s(B),{icon:"Add",size:"sm"}),o[2]||(o[2]=C("span",null,"Add Environment",-1))])),_:2},1032,["onClick"])):j("",!0)],2),[[Se,U(e.uid)]])])})),128))])),_:1})])])),button:h((()=>[f(Be,{click:T,hotkey:"N"},{title:h((()=>o[3]||(o[3]=[G(" Add Environment ")]))),_:1})])),_:1}),f(Re,{class:"flex-1"},{default:h((()=>[f(Te,null,Ve({default:h((()=>[y.value&&s(a)?(d(),_(je,{key:0,class:"py-2 pl-px pr-2 md:px-4",envVariables:s(r),environment:s(n),isCopyable:"",language:"json",lineNumbers:"",lint:"",modelValue:F(),workspace:s(a),"onUpdate:modelValue":N},null,8,["envVariables","environment","modelValue","workspace"])):j("",!0)])),_:2},[y.value?{name:"title",fn:h((()=>[C("span",null,H("default"===y.value?"Global Environment":y.value),1)])),key:"0"}:void 0]),1024)])),_:1}),f(Je,{selectedColor:I.value,state:s(p),onCancel:o[0]||(o[0]=e=>s(p).hide()),onSubmit:W},null,8,["selectedColor","state"]),f(Le,{activeWorkspaceCollections:s(t),collectionId:S.value,state:s(b),onCancel:o[1]||(o[1]=e=>s(b).hide()),onSubmit:A},null,8,["activeWorkspaceCollections","collectionId","state"]),f(s(q),{size:"xxs",state:s(x),title:`Edit ${z.value}`},{default:h((()=>[f(Me,{name:O.value??"",onClose:Y,onEdit:X},null,8,["name"])])),_:1},8,["state","title"])])),_:1}))}});export{pl as default};